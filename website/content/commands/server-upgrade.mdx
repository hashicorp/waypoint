---
layout: commands
page_title: 'Commands: Server upgrade'
sidebar_title: 'server upgrade'
description: 'Upgrades Waypoint server in the current context to the latest version'
---

# Waypoint Server upgrade

Command: `waypoint server upgrade`

Upgrades Waypoint server in the current context to the latest version

@include "commands/server-upgrade_desc.mdx"

## Usage

Usage: `waypoint server upgrade [options]`

Upgrade Waypoint server in the current context to the latest version or the
server image version specified. By default, Waypoint will upgrade to server
version "hashicorp/waypoint:latest". Before upgrading, a snapshot of the
server will be taken in case of any upgrade failures.

If a runner was installed via "waypoint install" then that runner will also
be upgraded to the latest version after the server is upgraded. Any other
manually installed runners will not be automatically upgraded.

#### Global Options

- `-plain` - Plain output: no colors, no animation.
- `-app=<string>` - App to target. Certain commands require a single app target for Waypoint configurations with multiple apps. If you have a single app, then this can be ignored.
- `-workspace=<string>` - Workspace to operate in.
- `-project=<string>` (`-p`) - Project to target.

#### Command Options

- `-auto-approve` - Confirm server upgrade.
- `-context-name=<string>` - Waypoint server context to upgrade.
- `-platform=<string>` - Platform to upgrade the Waypoint server from, defaults to the platform stored in the context.
- `-snapshot-name=<string>` - Filename to write the snapshot to. If no name is specified, by default a timestamp will be appended to the default snapshot name.
- `-snapshot` - Enable or disable taking a snapshot of Waypoint server prior to upgrades.

#### docker Options

- `-docker-server-image=<string>` - Docker image for the Waypoint server.
- `-docker-odr-image=<string>` - Docker image for the Waypoint On-Demand Runners. This will default to the server image with the name (not label) suffixed with '-odr'.

#### ecs Options

- `-ecs-cluster=<string>` - Configures the Cluster to upgrade.
- `-ecs-server-image=<string>` - Docker image for the Waypoint server.
- `-ecs-region=<string>` - Configures which AWS region to install into.
- `-ecs-cpu=<string>` - Configures the requested CPU amount for the Waypoint server task in ECS.
- `-ecs-mem=<string>` - Configures the requested memory amount for the Waypoint server task in ECS.
- `-ecs-odr-image=<string>` - Docker image for the Waypoint On-Demand Runners. This will default to the server image with the name (not label) suffixed with '-odr'.
- `-ecs-task-role-name=<string>` - IAM Execution Role to assign to the on-demand runner. If this is blank, an IAM role will be created automatically with the default permissions.
- `-ecs-odr-mem=<string>` - Configures the requested memory amount for the Waypoint On-Demand runner in ECS.
- `-ecs-odr-cpu=<string>` - Configures the requested CPU amount for the Waypoint On-Demand runner in ECS.

#### kubernetes Options

- `-k8s-advertise-internal` - Advertise the internal service address rather than the external. This is useful if all your deployments will be able to access the private service address. This will default to false but will be automatically set to true if the external host is detected to be localhost.
- `-k8s-context=<string>` - The Kubernetes context to upgrade the Waypoint server to. If left unset, Waypoint will use the current Kubernetes context.
- `-k8s-namespace=<string>` - Namespace to install the Waypoint server into for Kubernetes.
- `-k8s-openshift` - Enables installing the Waypoint server on Kubernetes on Red Hat OpenShift. If set, auto-configures the installation.
- `-k8s-server-image=<string>` - Docker image for the Waypoint server.
- `-k8s-odr-image=<string>` - Docker image for the Waypoint On-Demand Runners
- `-k8s-runner-service-account=<string>` - Service account to assign to the on-demand runner. If this is blank, a service account will be created automatically with the correct permissions.
- `-k8s-runner-service-account-init` - Create the service account if it does not exist.

#### nomad Options

- `-nomad-annotate-service=<key=value>` - Annotations for the Service generated.
- `-nomad-auth-soft-fail` - Don't fail the Nomad task on an auth failure obtaining server image container. Attempt to continue without auth.
- `-nomad-dc=<string>` - Datacenters to install to for Nomad.
- `-nomad-host=<string>` - Hostname of the Nomad server to use, like for launching on-demand tasks.
- `-nomad-namespace=<string>` - Namespace to install the Waypoint server into for Nomad.
- `-nomad-odr-image=<string>` - Docker image for the on-demand runners. If not specified, it defaults to the server image name + '-odr' (i.e. 'hashicorp/waypoint-odr:latest')
- `-nomad-policy-override` - Override the Nomad sentinel policy for enterprise Nomad.
- `-nomad-region=<string>` - Region to install to for Nomad.
- `-nomad-server-cpu=<string>` - CPU required to run this task in MHz.
- `-nomad-server-memory=<string>` - MB of Memory to allocate to the server job task.
- `-nomad-runner-cpu=<string>` - CPU required to run this task in MHz.
- `-nomad-runner-memory=<string>` - MB of Memory to allocate to the runner job task.
- `-nomad-server-image=<string>` - Docker image for the Waypoint server.
- `-nomad-host-volume=<string>` - Nomad host volume name.
- `-nomad-consul-service` - Create service for Waypoint UI in Consul.
- `-nomad-consul-service-hostname=<string>` - If set, will use this hostname for Consul DNS rather than the default, i.e. "waypoint-server.service.consul".
- `-nomad-consul-service-ui-tags=<string>` - Tags for the Waypoint UI service generated in Consul.
- `-nomad-consul-service-backend-tags=<string>` - Tags for the Waypoint backend service generated in Consul. The 'first' tag will be used when crafting the Consul DNS hostname for accessing Waypoint.
- `-nomad-consul-datacenter=<string>` - The datacenter where Consul is located.
- `-nomad-consul-domain=<string>` - The domain where Consul is located.

@include "commands/server-upgrade_more.mdx"
