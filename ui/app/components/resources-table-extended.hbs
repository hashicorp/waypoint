<Table
  data-test-resources-table
  @withMargin={{@withMargin}}
>
  <caption>{{yield to="caption"}}</caption>

  <colgroup>
    <col class="w-2/5">
    <col>
    <col>
    <col>
  </colgroup>

  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Age</th>
      <th>Status</th>
      <th>Provisioned by</th>
    </tr>
  </thead>

  <tbody>
    {{#each @resources key="id" as |resourceObject|}}
      {{#with resourceObject.resource as |resource|}}
      <tr>
        <th scope="row">
          <LinkTo
            title={{resource.name}}
            @route={{@route}}
            @models={{append (or @models (array)) resource.id}}
          >
            {{resource.name}}
          </LinkTo>
        </th>
        <td class="resource-icon"><FlightIcon @name={{icon-for-component resource.platform}} /> {{resource.type}}</td>
        <td>{{date-format-distance-to-now resource.createdTime.seconds}}</td>
        <td><ResourceHealthIndicator @resource={{resource}} /></td>
        <td>
          {{#if (eq resourceObject.type 'deployment')}}
            <LinkTo
              title={{concat (t "page.deployment.title") " v" resourceObject.source.sequence}}
              @route="workspace.projects.project.app.deployment.deployment-seq"
              @models={{array resourceObject.source.sequence}}
              >
              Deployment <b class="badge badge--version">v{{resourceObject.source.sequence}}</b>
            </LinkTo>
          {{/if}}
          {{#if (eq resourceObject.type 'release')}}
            <LinkTo
              title={{concat (t "page.release.title") " v" resourceObject.source.sequence}}
              @route="workspace.projects.project.app.release-id"
              @models={{array resourceObject.source.sequence}}
              >
              Release <b class="badge badge--version">v{{resourceObject.source.sequence}}</b>
            </LinkTo>
          {{/if}}
        </td>
      </tr>
      {{/with}}
    {{/each}}
  </tbody>
</Table>
