<PageHeader @iconName="upload">
  <div class="title">
    <h1><b class="badge badge--version">v{{@model.sequence}}</b></h1>
    <small>
      <Pds::Icon @type={{icon-for-component @model.component.name}} class="icon" />
      <span>Deployed by <b>{{component-name @model.component.name}}</b>
        {{date-format-distance-to-now @model.status.startTime.seconds }}</span>
    </small>
  </div>
  <div class="actions">
    <div class="button-group">
      <ExternalLink
        href={{enforce-protocol @model.preload.deployUrl}}
        class="button button--secondary button--external-link">
        <span>{{lowercase @model.preload.deployUrl}}</span>
        <Pds::Icon @type="exit" class="icon" />
      </ExternalLink>
      <Actions::Release @sequence={{@model.sequence}} />
    </div>
  </div>
</PageHeader>

<div class="status-row">
  <div class="item">
    {{#if @model.statusReport}}
      {{#let @model.statusReport.health as |health|}}
        <StatusBadge
          @state={{health.healthStatus}}
          @message={{health.healthMessage}}
          @tooltipSide="right"
        />Â 
      {{/let}}
    {{/if}}
  </div>

  {{#if @model.build}}
  <div class="item">
    <small>
      Build <a href="#"><b class="badge badge--version">#{{@model.build.sequence}}</b>
        <code>{{@model.build.id}}</code></a>
    </small>
  </div>
  {{/if}}
  {{#if @model.statusReport.status.completeTime.seconds}}
    <div class="item">
      Last checked {{date-format-distance-to-now @model.statusReport.status.completeTime.seconds }}
    </div>
  {{/if}}
  <div class="item">
    <Pds::Button @variant="ghost" @iconStart="refresh-default" onclick={{on 'refreshHealthCheck'}}>
      Re-run health check
    </Pds::Button>
  </div>
</div>

<OperationLogs @jobId={{@model.jobId}} />
